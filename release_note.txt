Touch Down Center 
Release Notes

V3.7.17 (2015-06-26)
	Some improvement in Emergency Event pages.  Add $support_emg=1;  to enable "Emergency" ;
	Close live setup connection instead of keep connection and send trunk data

V3.7.16 (2014-07-29) (by Dennis)
	Add Emergency Event page, (for tvs emergency , event marker, crashes ) 
	Fix driveby report email contents 
	Email allow carry-return, semi-colon as separator of recipients 
	
V3.7.15 (2014-07-23) (by Dennis)
	Driveby page contain 5 tabs , "New Events", "Processed Events", "Deleted Events", "Reports", "Deleted Reports".
	More columns in event lists.
	Add search function on all columns of event list. Input of search to match begin of the value in list.
	Add 14 Months event summary table.
	All events are store in database instead of tag files. ( Table drive_by_event should be updated to contain new fields )
	Use TDWin email setting for report sending, Support TLS/SSL,  (TO support secure connection, in php.ini should un-comment extension line: extension=php_openssl.dll )
		TLS send email tested on gmail accounts, the gmail would replace email sendor to the account id, the input sender email will be hidden as in header "X-Original-From:"
		
	
adriveby feature. Set $support_driveby to 1 in 'config.php' to enable driveby feature.
		* list of drive events
		* 4 video screen with frame by frame forward / backward
		* static picture map 
		* generate .PDF file report
		* send report over email
	Some other minor bug fix

V3.7.14 (2014-06-27) (by Dennis)
	Add driveby feature. Set $support_driveby to 1 in 'config.php' to enable driveby feature.
		* list of drive events
		* 4 video screen with frame by frame forward / backward
		* static picture map 
		* generate .PDF file report
		* send report over email
	Some other minor bug fix

V3.7.13 (2014-05-02) (by Dennis)
	Decrease live setup register timeout to 0.2 seconds

V3.7.12 (2014-04-24) (by Dennis)
	Fix save live track configure max_count, max_bytes to new defined fields on table 'vlt_config'
	On display live track route event icon, speed value have higher priortiy then stop arm status. 
	Fix database backup/restore script failure on multi-company mode.
	Add speed field on report view export
    Delayed map object creating on page "Map View", "Live Track", "Settings Zones" , "Settings MSS" (fix chrome v34 map issur)
	Add Dashbard summary list dialog
	Multi-Company login failure fixed

V3.7.11 (2014-04-22) (by Dennis)
	Add TDWeb multi company login
	Add TDWeb multi company management
	All companys use local database and local file system (one set of database autherization)
	On create new company, call TDWin creating script/excutable. script name set on variable $td_new in file config.php.
	Creating script executed with parameters:   <script> <company id> <company root directory> <database name>
	On remove company, call TDWin removing script/excutable. script name set on variable $td_clean in file config.php.
	Removing script executed with parameters:   <script> <company id> <company root directory> <database name>
    Each company site has a unique company ID and company root folder
    All companies use a single MySQL server and has their own database
    On logon screen, leave company id empty and enter "SuperAdmin" as user name to enter company management mode. Default password for "SuperAdmin" is empty.
    Create a new company will create a file name "config.php" under "client/<id>" folder, do not encode, compile or obfuscate this file.
    On create or remove a company , tdweb would execute script to setup or remove all data/database related to this company. (Tongrui to provide these script/utility)
    On each company root folder would generate a file named "companyinfo.xml" , it contain company information entered on company management page. The file is in XML format.


V3.7.10 (2014-04-09) (by Dennis)
	Add “Play back” button to live track page
	Live DVR setup over td web tunneling (for DVR with internal mobile ip) (only admin can access this feature)
	Add relay support on “Live view” and “Play Back”
	Parameter  $liveplay_protocol = "relay" ; should be added to config.php to support new features.
	Parameter  $liveplay_host is public ip address of relay server (ask Harrison for detail) , if relay server run on same PC of TDWeb server, this parameter is optional, TDWeb will try to detect its own public ip.


V3.7.9 (2014-03-19) (by Dennis)
	Fix km/h to mph convertion on live track transfer.
	MapView show infobox on click of event icons, some browser ( Chrome on Android ) do not response to mouse over event.
	Add Multi Client ID support in on TDWeb, each client has a separated configuration file.  
    Each Client's TD Server (tdwin upload server) can be located in same PC or be connected through IP internet.
    Default client will works as before, without client id. 
    Client ID (if available) will be displayed on bottom-right corner of sign-in box

	To add a new Client,
		1. Create a new directory on /TouchDownCenter/www/tdc/client/<new client id>
		2. Copy 2 files from  /TouchDownCenter/www/tdc/client/example  to this new created directory.  ("config.php" and "index.php")
		3. Use an text editor to make changes of /TouchDownCenter/www/tdc/client/<new client id>/config.php
		4. Following variables should be unique for each client configuration
				$smart_host, $smart_database, $mss_conf, $dashboard_conf, $backup_path
		
	To use/login with a specific client id, use url (example) :
		http://192.168.42.52/tdc/client/<client id>
	or
		http://192.168.42.52/tdc/logon.php?cid=<client id>
		
	To login as default client (clear remembered client id), use url:
		http://192.168.42.52/tdc/client	
		

V3.7.8 (2014-02-25) (by Dennis)
	Add address input on "MAP VIEW" page
	Right click on "MAP VIEW" map to display address, only if address can be retrieved, so click close to roads.
	Click "Copy Address" link on address infobox to copy address to address input
	Do not remove infobox on "MAP VIEW" when map is moved. (Work around DELL touch screen issue)
	Fix email settings bug.

V3.7.7 (2014-02-19) (by Dennis)
	Add ignition on event and icon on LiveTrack
	Add temperature event and icon on LiveTrack
	Add idling event on LiveTrack
	Check on "Stop Arm On" sensor status and display "Bus stop" icon if the sensor is on
	Live track auto-report unit changed to imperial
	Do not reset live track auto-report dialog inputs when open/close the dialog
	Fix save default bugs on blank input field
	Get current position auto zoom in. Set parameter "$livetrack_autozoomin" for zoom in level.
	Videos preview automaticall open next clip when current clip ended.
	Video preview no stable issue may fixed. (add screen wait to prevent user repeatly click "Preview Video Clip" button too quick)
	
	(Many mods on supporting TD Server and video file server from the PC other than web server, every thing sould work fine if all servers are run in the same server, for now. )

V3.7.6 (2014-01-23) (by Dennis)
	Change Live Track igintion event icon, use sensor icon for ignition on event, use paring icon for ignition off event.


V3.7.5 (2013-12-19)
	Fix report view export failed on Firefox browser
	Add live track command 22 (event) icon display

V3.7 (2013-12-18)
	Report View export to .csv file
	Some typo corrected
	Some adjusts on map filter options
	Add support of "Drive By" events
	Fix unable to save "Storage&Bacup" options, (Caused by trailing backslash in directory options)
	Video preview feature removed

	
V3.6 (2013-12-17)
	Add target="_blank" to all file downloading links, to fix incompatibility between IE and other web browser
	Fix date error on live track infobox
	Fix normal user delete quick filter of other users
	Change "user defined" zone name to "Current Map"
	Add "Default Area" to zone list on "Map View" page
	Add "Default Area" to zone setup page
	"Default Area" defined by "$map_area" variable in config.php file.
	Create new zone on current displayed map
	Options to disable "live track" feature, by modify "$enable_livetrack" variable in config.php file
	Add address search for "Create Zone" page
	Prompt keep video data warning
	Prompt keep gps data warning
	Add more space on map filter inputs
	Use accordion to hide/show map filter events and g-force inputs
	Search "button" on zone setup page
	

V3.5 (2013-12-05)
	Add a few new icons for live track events
	Add "Setup DVR" button on live track
	Centering map on live track event only when the event icon is outside map viewable area


V3.4 (2013-11-28)
	Live track features
		Features are duplicated from TDManagement software
		Communicate with a program named "AVL Service" for all live track information. Ask Tongrui Zhang for details about this software. I do not maintain this software.
		Each browser tab (window) use one live track session and has its own auto-report settings.
		Support live view over internet (mobile), by click "Live View" button to download a .dpl file and open it with "DVRViewer".
	Add channel selection on web playback

	
V3.3 (2013-11-1)
	Fix play list file https error
	Add on web video file playback (Not official feature)
		It is hidden by default, to enable it, set $webplay_support to 1 in config.php, load "videos" page, search and select one video, click "Preview Video Clip".
		This is clips based video play, total depends on web browser support for back back controls.
		MP4 format only for HTML <video> tag. Would works on windows, androids devices.  Almost all recent browser should work.  ( for IE, please update to version 10 ) (Firefox also works ^^)
		Trans-code on server, expect some delay when opening
		No audio, audio format on .266 are specific to TME, no chance to make it work except some one can ask the developer of .266
		No OSD, same reason as above.
		If video did not auto start or show error, try click reload.
		Again, this is not official feature, I only thought this could be cool and may be useful. ( Don't report as bugs if it doesn't work well, leave it hidden )

V3.2 (2013-10-28)
	Add Player (DVRViewer) download button. Installation file default is "player\player.msi", can be changed in config.php file with "$playerinstallfile" .
	Add "$support_https_playback" setting in config.php. If it set and non-zero, playback to use same protocol as web browsing, otherwise use http.
	 

V3.1 (2013-10-21)
	Play Video anchor on Map View Icon's Infobox
	Separated video playing session files, to avoid video playing affect web interface
	Sync MAP VIEW to dvrviewer (need player support) 

V3.0 (2013-10-08)
	Playback over http support
	On video page add play button
	Correct some typo 

V2.9 (2013-07-31)
	Row number column on report view grid widened.

V2.8 (2013-07-12)
	A jqgrid fix for IE browser. (the ugly empty line on vehicle list)
	Disable duration sorting on vehicle list, may fix this later

V2.7 (2013-07-11)
	Count video clips number and time also based on clip end time.
	Discard point to point distance larger than 1km on travel calculating.
	New g-force event icons
	Multiple g-force icon on single g-force event if g-force event match multiple-conditions
	Count of g-force events only when event selected on "Events Summary"
	Count of speeding totals only when speeding selected on "Events Summary"
	Show route (green) icon if speeding is not selected
	Add exact time range configure variable in 'config.php', default value is 10 minutes
	Use jqGrid for Dashboard vehicle list, so it is sortable

V2.6 (2013-07-05)
	MapView and ReportView shared same filter parameters.
	MapView and ReportView filter parameters to be persist during one login session, still need to click "Generate" to get result
	Dashboard option display items removed.
	TD alerts (top-right corner) display current day's alerts, display previous day's alerts on "Morning Status Report" page.
	Delayed dashboard report requests, to prevent page loading hangs (some times on slow database)
	Display alerts types instead of alerts number on "Vehicle Status List"
	Event infobox display event icon.
	Event infobox display event duration, speed, g-force value if available.
	Add serial number on event request and response check, to prevent infobox flushing.
	Double click on "Event list" of "ReportView" to display event icon on map.
	Click on "Event list" of "ReportView" to update event icon on map.
	Add "required" attributes for some input fields (user name, vehicle name, etc.), supported by most browser, include firefox, IE10 but not IE9
	Add "Auto Search" for vehicles list, to automatically search vehicles name form table 'vl', 'videoclip', 'td_event' and 'dvr_event', and update existing vehicles list.
	Add "Delete All", "Import", "Export" for vehicles list, driver list and user list, 
	"Export" feature to download .CSV file of related table, auto-increment field may not be exported based on configure variable $backup_auto_increment. (careful!, leave it along if to do cross server import/export)
	"Import" to upload .CSV file and update related table, don't do any file format checks, so be careful and only "admin" are allowed.
	"admin" account are not deletable, importable and exportable. 
	"Import" and "Auto Search" only do non-destructive updates, all existing items (duplicated keys) will not be updated. (Table 'driver' do not has unique key, so it will always been appended on importing, don't blame on me!!!)
	Add "Email Setup" page.
	Change button "Reset" to "Cancel" to prevent confusing.
	Restore progress support more than 2G of database size. Add internal records size in .sql files. ( May not work on .sql file from other source with size more than 4G ).
	Vehicle setting "Out Of Service" error fixed.
	Page layout changed, footer section removed, server time displayed on top, company name moved to top-left corner below TM icon
	
V2.5
	Change user setup, only "admin" can create/delete/change other user account, "power user" and "user" can only change own account. 
	"user name" can't be changed. Change "user name" might cause problems in previous version.
	Dashboard option use external file, allow "power user" and "admin" to change. 
	Add serial number on report requests, long running requests won't mess out reporting result.
	Add serial number on map event request, eliminate map icon flashing.
	Remove map event request delay, make map icon display a bit faster (about half seconds).
	Fix database backup/restore bugs, which might insert unnecessary space into line breaks. Might happens on restore .sql files generated by 'mysqldump' utility.
	Remove backup of AUTO_INCREMENT table fields. AUTO_INCREMENT fields would auto-generate on restore. Set option "$backup_auto_increment" to 1 in "config.php" to backup AUTO_INCREMENT table fields.
	Experiment using temporary table to cache report view grid. Option "$map_events_cache" set to 1. 
	
V2.4
	Report View / Videos grid show empty by default 
	Adjust icon location on MapView and ReportView page
	Database backup/restore use internal script instead of MySql utility. 
	Display progress dialog during database backup/restore
	Compress/Uncompress backup file in real time. Support .gz and .bz2 file
	Add "Keep GPS Data Within" and "Keep GPS Data Within" options to system storeage setting page
	Add "MaxConcurrentUpload" item to Default Event Parameters page
	Add "New My Zone" button to create private map zone. Private zone can't be view or change by other users.
	Change map zone border drag mode, center point keep static when drag corner points. Add $zone_mode = "cross"  in config.php to change back to old mode.
	Commit new zone to server instead of cached in browser.
	Support SMART SERVER MANAGER password. Not use 'shadow' field on table 'app_user' any more. (not compatible with previous TDC web app)
	Use md5 hash password if detect 'user_password' field length is longer than 68. (New version of SMART SERVER MANAGER would support this also)
	Display real user first name and last name on header.
	Display version number on header.
	Adjusted all session codes , slim down souce codes.

V2.3
	Fix security bug, user account may change its own account into admin account.
	Erase older user_password field on password change
	Add session_write_close() to all files, decrease chances of session dead lock.
	Company link change to 247security Inc. on footer
	Default map location to use $map_area.
	Use late row lookup technique for report view grid paging, improved performance on huge date.	
	
V2.2
	Dashboard info 'Vehicles Uploaded' to count on 'time_upload' instead of 'time_start'. 
	Auto detect map default location.
	Remember map location in the same session, mapview would keep previous view when user click back.
	Add options to jqgrid scrolling mode. Virtual scrolling is broken on huge tables.
	Default to use paging mode instead of scrolling mode on jqgrid.
	Divide event summary query into 5 steps (add 2 more). To minimize query broken. (PHP have 30s limit, any query longer than that may be quietly killed).
	New speeding calculating method, by query all over-speed events, if a gap between events last more than 1 minute, count as another speeding.
	Display 'loading' text on event summary when loading data.
	Dashboard pages to use mysql time on top of php time, in case php time zone not been set correctly.
	Update alerts and server time on footer every 1 minute. 
		
V2.1	
	Enable virtual scrolling on jqgrid
	Optimize SQL filter for map generating .
	Fix dashboard errors on 'Hours of videos' when query on video files that cross midnight.
	Make zone "No Restriction" and "User Define" special.
	Using zone "No Restriction" would remove all limit on event coordinate.
	Using zone 'User Define" would remove all limit on event coordinate and not to change map view on "Generate". 

V2.0
	Map view add 'grid' and 'limited' method to reduce push pins number on map. use 'grid' mode as default.
	Map view filtering in 2 steps, first generate filter and return map area cover all events, change map view,  and  then fetch event items.
	Use jqgrid for report view and videos list		
		
V1.0
	First testing release
	